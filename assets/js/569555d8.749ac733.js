"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[5155],{3905:function(e,n,a){a.d(n,{Zo:function(){return i},kt:function(){return d}});var r=a(7294);function t(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function o(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?o(Object(a),!0).forEach((function(n){t(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function p(e,n){if(null==e)return{};var a,r,t=function(e,n){if(null==e)return{};var a,r,t={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],n.indexOf(a)>=0||(t[a]=e[a]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(t[a]=e[a])}return t}var c=r.createContext({}),l=function(e){var n=r.useContext(c),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},i=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},k={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var a=e.components,t=e.mdxType,o=e.originalType,c=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),u=l(a),d=t,m=u["".concat(c,".").concat(d)]||u[d]||k[d]||o;return a?r.createElement(m,s(s({ref:n},i),{},{components:a})):r.createElement(m,s({ref:n},i))}));function d(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=a.length,s=new Array(o);s[0]=u;var p={};for(var c in n)hasOwnProperty.call(n,c)&&(p[c]=n[c]);p.originalType=e,p.mdxType="string"==typeof e?e:t,s[1]=p;for(var l=2;l<o;l++)s[l]=a[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},5271:function(e,n,a){a.r(n),a.d(n,{contentTitle:function(){return c},default:function(){return u},frontMatter:function(){return p},metadata:function(){return l},toc:function(){return i}});var r=a(7462),t=a(3366),o=(a(7294),a(3905)),s=["components"],p={title:"[Yarn] workspaces",tags:["yarn","workspace"]},c=void 0,l={unversionedId:"NPM/yarn-workspaces",id:"NPM/yarn-workspaces",isDocsHomePage:!1,title:"[Yarn] workspaces",description:"WHY",source:"@site/docs/NPM/yarn-workspaces.md",sourceDirName:"NPM",slug:"/NPM/yarn-workspaces",permalink:"/docs/NPM/yarn-workspaces",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/NPM/yarn-workspaces.md",tags:[{label:"yarn",permalink:"/docs/tags/yarn"},{label:"workspace",permalink:"/docs/tags/workspace"}],version:"current",frontMatter:{title:"[Yarn] workspaces",tags:["yarn","workspace"]},sidebar:"tutorialSidebar",previous:{title:"[React] React.memo",permalink:"/docs/React/react-react-memo"},next:{title:"[Git] reflog",permalink:"/docs/Git/git-reflog"}},i=[{value:"WHY",id:"why",children:[]},{value:"Yarn Workspace Setting",id:"yarn-workspace-setting",children:[]},{value:"Yarn Workspace \u7bc4\u4f8b",id:"yarn-workspace-\u7bc4\u4f8b",children:[]},{value:"Yarn Workspace nohoist",id:"yarn-workspace-nohoist",children:[]},{value:"Ref",id:"ref",children:[]}],k={toc:i};function u(e){var n=e.components,a=(0,t.Z)(e,s);return(0,o.kt)("wrapper",(0,r.Z)({},k,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"why"},"WHY"),(0,o.kt)("p",null,"\u70ba\u4ec0\u9ebc\u6211\u5011\u6703\u9700\u8981 workspaces \u7684\u529f\u80fd\u5462\uff1f"),(0,o.kt)("p",null,"\u7576\u4e0d\u540c\u7684\u5c08\u6848\u9700\u8981\u7528\u5230\u76f8\u540c\u7684\u6a21\u7d44\u7684\u6642\u5019\uff0c\u6700\u76f4\u63a5\u7684\u89e3\u6cd5\u5927\u6982\u5c31\u662f copy & past \u4f86\u8655\u7406\uff0c\u4f46\u662f\u5beb\u7a0b\u5f0f\u91cd\u8907\u5beb\u4e00\u6a23\u7684\u7a0b\u5f0f\u7562\u7adf\u4e0d\u662f\u4e00\u500b\u597d\u7684\u8655\u7406\u65b9\u5f0f\uff0c\u5047\u8a2d\u4eca\u5929\u662f\u500b\u62ff\u5546\u54c1\u8cc7\u6599\u7684\u7a0b\u5f0f\uff0c\u53ef\u80fd\u6709\u597d\u5e7e\u500b\u5730\u65b9\u9700\u8981\u7528\u5230\uff0c\u6bd4\u5982\u8aaa\u6709 APP \u3001Web frontend\uff0c\u751a\u81f3 frontend \u53ef\u80fd\u6839\u64da\u4e0d\u540c\u8a9e\u7cfb\u5206\u6210\u5e7e\u500b\u4e0d\u540c\u7684\u5c08\u6848\uff0c\u9019\u6a23\u5047\u8a2d API response \u6709\u9ede\u7570\u52d5\u7684\u6642\u5019\u5c31\u9700\u8981\u5230\u5404\u500b repository \u66f4\u6539\u9019\u6bb5 fetch products \u7684\u7a0b\u5f0f\u3002"),(0,o.kt)("p",null,"\u53c8\u6216\u8005\u8aaa\u74b0\u5883\u7684\u8a2d\u5b9a\u6bd4\u5982 ESLint \uff0c\u5728\u4e00\u500b\u5718\u968a\u4e2d\u6240\u4f7f\u7528\u7684 ESLint \u7684\u898f\u5247\u61c9\u8a72\u662f\u6bcf\u500b\u5c08\u6848\u7684\u6703\u4e00\u6a23\uff0c\u4f46\u662f\u5728\u8d77\u4e00\u500b\u65b0\u5c08\u6848\u7684\u6642\u5019\u5c31\u6703\u9700\u8981\u91cd\u65b0\u8a2d\u5b9a ESLint \u7684\u898f\u5247\u3002"),(0,o.kt)("p",null,"\u56e0\u6b64 yarn workspaces \u80fd\u5e6b\u5fd9\u89e3\u6c7a\u5728\u4e0d\u540c\u7684\u5c08\u6848\u4e2d\u5171\u7528\u7a0b\u5f0f\u78bc\uff0c\u4ee5\u53ca\u53ea\u9700\u8a2d\u5b9a\u4e00\u6b21\u74b0\u5883\u53ca\u4e0d\u5fc5\u91cd\u8907\u5b89\u88dd\u4f9d\u8cf4\u3002"),(0,o.kt)("h2",{id:"yarn-workspace-setting"},"Yarn Workspace Setting"),(0,o.kt)("p",null,"yarn \u7684 workspace \u5728 v1 \u5c31\u53ef\u4ee5\u4f7f\u7528\u4e26\u4e14\u9810\u8a2d\u70ba\u958b\u555f\u3002"),(0,o.kt)("p",null,"\u9996\u5148\u5efa\u7acb\u4e00\u500b\u5c08\u6848\u8cc7\u6599\u593e\u505a\u70ba workspace root \u800c\u9019\u500b\u76ee\u9304\u4e0b\u5b89\u88dd\u7684\u5957\u4ef6\u6240\u7522\u751f\u7684 node_modules \u5247\u7a31\u70ba root node_modules\u3002"),(0,o.kt)("p",null,"\u63a5\u8457\u900f\u904e ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn init -y")," \u4f86\u521d\u59cb\u5316",(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/luofreddy/images/main/uPic/2022/04/05/%E6%88%AA%E5%9C%96%202022-04-05%20%E4%B8%8B%E5%8D%8810.27.30.png",alt:"yarn init"})),(0,o.kt)("p",null,"\u6b64\u6642\u6703\u7522\u751f package.json"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "yarn-workspace",\n  "version": "1.0.0",\n  "main": "index.js",\n  "license": "MIT"\n}\n\n')),(0,o.kt)("p",null,"\u70ba\u4e86\u4f7f\u7528 worksapce \u6211\u5011\u505a\u4e00\u4e9b\u8abf\u6574\uff0c\u9996\u5148\u505a\u70ba workspace root \u6211\u5011\u9700\u8981\u628a private \u8a2d\u5b9a\u70ba true\uff0c\u56e0\u70ba workspace root \u4e0d\u8a72\u88ab\u767c\u5e03\u51fa\u53bb\u3002"),(0,o.kt)("p",null,"\u800c workspaces \u4e0b\u7684 packages \u5247\u8aaa\u660e\u4e86\u54ea\u4e9b\u5b50\u76ee\u9304\u6703\u662f\u5de5\u4f5c\u5340\uff0c\u6240\u4ee5\u7167\u9019\u6a23\u8abf\u6574\u7684\u8a71\u6703\u8b8a\u6210\u4e0b\u9762\u9019\u6a23"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "yarn-workspace",\n  "version": "1.0.0",\n  "private":true,\n  "license": "MIT",\n  "workspaces":{\n    "packages": [\n      "packages/*"\n    ]\n  }\n}\n')),(0,o.kt)("p",null,"\u63a5\u8457\u5efa\u7acb\u5e7e\u500b\u8cc7\u6599\u593e\u4f86\u4f5c\u70ba\u5de5\u4f5c\u5340"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 packages\n    \u251c\u2500\u2500 a-workspace\n    \u251c\u2500\u2500 b-workspace\n    \u2514\u2500\u2500 c-workspace\n")),(0,o.kt)("p",null,"\u9032\u5230\u5404\u5de5\u4f5c\u5340\u57f7\u884c ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn init")," \u4e26\u4e14\u628a package.json \u6539\u6210\u50cf\u662f\u4e0b\u9762\u9019\u6a23"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'// a-workspace/package.json\n{\n  "name": "@yarn-workspace/a-workspace",\n    ...\n}\n\n')),(0,o.kt)("p",null,"\u7136\u5f8c\u6211\u5011\u5c31\u53ef\u4ee5\u901a\u904e\u4e0b\u9762\u5169\u500b\u6307\u4ee4\u4f86\u5c0d\u5404\u500b workspace \u5b89\u88dd\u4f9d\u8cf4"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u5728 root workspace"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspace @yarn-workspace/a-workspace add lodash\n\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u5728\u7279\u5b9a\u7684 workspace"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd b-workspace\nyarn add lodash\n")))),(0,o.kt)("p",null,"\u57f7\u884c\u5b8c\u4e0a\u9762\u9019\u5169\u884c\u53ef\u4ee5\u770b\u5230\u53ea\u6709 ",(0,o.kt)("inlineCode",{parentName:"p"},"lodash")," \u88ab\u5b89\u88dd\u5728 root node_dash \u7ba1\u7406"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/luofreddy/images/main/uPic/2022/04/06/%E6%88%AA%E5%9C%96%202022-04-06%20%E4%B8%8B%E5%8D%8810.21.50.png",alt:"\u622a\u5716 2022-04-06 \u4e0b\u534810.21.50"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'// a-workspace/package.json\n{\n  "name": "@yarn-workspace/a-workspace",\n  "version": "1.0.0",\n  "main": "index.js",\n  "license": "MIT",\n  "dependencies": {\n    "lodash": "^4.17.21"\n  }\n}\n\n//b-workspace/package.json\n\n{\n  "name": "@yarn-workspace/b-workspace",\n  "version": "1.0.0",\n  "main": "index.js",\n  "license": "MIT",\n  "dependencies": {\n    "lodash": "^4.17.21"\n  }\n}\n')),(0,o.kt)("h2",{id:"yarn-workspace-\u7bc4\u4f8b"},"Yarn Workspace \u7bc4\u4f8b"),(0,o.kt)("p",null,"\u5728 a-workspace \u5efa\u7acb\u7bc4\u4f8b\u7a0b\u5f0f index.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const _ = require('lodash')\nconst random = () => {\n  console.log('a-workspace')\n  return _.random(1, 100, false)\n}\nmodule.exports = random\n")),(0,o.kt)("p",null,"\u63a5\u8457\u5728 b-workspace \u5f15\u5165"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspace @yarn-workspace/b-workspace add @yarn-workspace/a-workspace@^1.0.0\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u9019\u908a\u8981\u8a18\u5f97\u52a0\u4e0a\u7248\u672c\u865f\uff0c\u800c\u7248\u672c\u865f\u5c31\u662f\u5728 package.json \u88e1\u9762\u7684 version")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/luofreddy/images/main/uPic/2022/04/06/%E6%88%AA%E5%9C%96%202022-04-06%20%E4%B8%8B%E5%8D%8810.34.30.png",alt:"\u622a\u5716 2022-04-06 \u4e0b\u534810.34.30"})),(0,o.kt)("p",null,"\u5982\u6b64\u4e00\u4f86\u6211\u5011\u5c31\u53ef\u4ee5\u5171\u7528\u7a0b\u5f0f\u78bc\u4e86"),(0,o.kt)("h2",{id:"yarn-workspace-nohoist"},"Yarn Workspace nohoist"),(0,o.kt)("p",null,"\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u53ef\u80fd\u67d0\u4e9b\u4f9d\u8cf4\u4e0d\u60f3\u8981\u62ff\u5230 root node_moudles \uff0c\u53c8\u6216\u662f\u5404\u500b workspace \u5728\u540c\u4e00\u500b\u5957\u4ef6\u4e0b\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7684\u7248\u672c\uff0c\u9019\u6642\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528 nohoist \uff0c\u6703\u50cf\u4e0b\u9762\u9019\u6a23\u8a2d\u5b9a\u5728 root workspace \u7684 package.json"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "yarn-workspace",\n  "version": "1.0.0",\n  "private":true,\n  "license": "MIT",\n  "workspaces":{\n    "packages": [\n      "packages/*"\n    ],\n    "nohoist": [\n      "@yarn-workspace/a-workspace/redux"\n    ]\n  }\n}\n \n')),(0,o.kt)("p",null,"\u7136\u5f8c\u6dfb\u52a0 redux \u5230 a-workspace"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd packages/a-workspace\nyarn add redux\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/luofreddy/images/main/uPic/2022/04/07/yarn-workspaces-result.png",alt:"\u622a\u5716 2022-04-06 \u4e0b\u534810.57.08"})),(0,o.kt)("p",null,"\u53ef\u4ee5\u770b\u5230 redux \u88ab\u5b89\u88dd\u5728 a-workspace \u4e0b\u7684 node_modules \u800c root node_modules \u5c31\u6c92\u6709\u88ab\u5b89\u88dd redux\u3002"),(0,o.kt)("p",null,"\u5982\u679c\u60f3\u770b\u770b\u66f4\u591a\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528\u6211\u5efa\u597d\u7684 ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/luofreddy/yarn-workspaces"},"repo")," \u64cd\u4f5c\u770b\u770b"),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"ref"},"Ref"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://tokileecy.medium.com/%E7%AD%86%E8%A8%98-yarn-workspaces-%E5%9F%BA%E7%A4%8E%E6%95%99%E5%AD%B8-cbb16bb780ec"},"[\u7b46\u8a18] Yarn Workspaces \u57fa\u790e\u6559\u5b78")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://hateonion.me/posts/b2b0/"},"\u4f7f\u7528Yarn Workspace\u7ba1\u7406\u591aproject repo"))))}u.isMDXComponent=!0}}]);